setfile("beam", "gpt_particles.gdf");
time=0.0;
auto_phase=0.0;
space_charge=0.0;
cathode=0.0;
space_charge_type=1.0;
RadiusMax=0.04;
GBacc=5.5;
xacc=6.5;
accuracy(GBacc, xacc);
dtmin=1e-16;
dtmax=1e-10;

Alpha=1.0;
Fn=0.5;
verror=0.005;
Nstd=5.0;
tree_code_theta=1.0;
tree_code_R=1e-06;
if (space_charge == 1) {

    if (space_charge_type == 1) {
        if(cathode == 1) {
            spacecharge3Dmesh("MeshNfac", Alpha, "MeshAdapt", Fn, "SolverAcc", verror, "MeshBoxSize", Nstd);
        } else {
            spacecharge3Dmesh("Cathode", "MeshNfac", Alpha, "MeshAdapt", Fn, "SolverAcc", verror, "MeshBoxSize", Nstd);
        }    }
    if (space_charge_type == 2) {
        setrmacrodist("beam","u",tree_code_R,0) ;
        spacecharge3Dtree(tree_code_theta) ; 
    }
}
Ntout=50.0;
tmax=10e-9;
ZSTART=-0.005;
ZSTOP=3;
zminmax("wcs", "I", ZSTART, ZSTOP);

if(Ntout>0) {
    tout(time, tmax, tmax/Ntout);
}

cav01_x = 0.0;
cav01_y = 0.0;
cav01_z = 0.57;
cav01_scale = 6000000.0;
cav01_oncrest_phase = 7.60733621434517;
cav01_relative_phase = 0;
cav01_phase = (cav01_oncrest_phase + cav01_relative_phase)*pi/180;
cav01_k = 0;
cav01_frequency = 1300000000.0;
Map25D_TM("wcs", cav01_x, cav01_y, cav01_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav01_scale, cav01_k, cav01_phase, 2*pi*cav01_frequency);
cav02_x = 0.0;
cav02_y = 0.0;
cav02_z = 1.96;
cav02_scale = 6000000.0;
cav02_oncrest_phase = -4.52194860611065;
cav02_relative_phase = 0;
cav02_phase = (cav02_oncrest_phase + cav02_relative_phase)*pi/180;
cav02_k = 0;
cav02_frequency = 1300000000.0;
Map25D_TM("wcs", cav02_x, cav02_y, cav02_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav02_scale, cav02_k, cav02_phase, 2*pi*cav02_frequency);
cav03_x = 0.0;
cav03_y = 0.0;
cav03_z = 3.3499999999999996;
cav03_scale = 6000000.0;
cav03_oncrest_phase = -15.349160980978104;
cav03_relative_phase = 0;
cav03_phase = (cav03_oncrest_phase + cav03_relative_phase)*pi/180;
cav03_k = 0;
cav03_frequency = 1300000000.0;
Map25D_TM("wcs", cav03_x, cav03_y, cav03_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav03_scale, cav03_k, cav03_phase, 2*pi*cav03_frequency);
cav04_x = 0.0;
cav04_y = 0.0;
cav04_z = 4.74;
cav04_scale = 6000000.0;
cav04_oncrest_phase = -25.761582320986943;
cav04_relative_phase = -180;
cav04_phase = (cav04_oncrest_phase + cav04_relative_phase)*pi/180;
cav04_k = 0;
cav04_frequency = 1300000000.0;
Map25D_TM("wcs", cav04_x, cav04_y, cav04_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav04_scale, cav04_k, cav04_phase, 2*pi*cav04_frequency);
cav05_x = 0.0;
cav05_y = 0.0;
cav05_z = 6.13;
cav05_scale = 6000000.0;
cav05_oncrest_phase = -36.514771186187474;
cav05_relative_phase = -180;
cav05_phase = (cav05_oncrest_phase + cav05_relative_phase)*pi/180;
cav05_k = 0;
cav05_frequency = 1300000000.0;
Map25D_TM("wcs", cav05_x, cav05_y, cav05_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav05_scale, cav05_k, cav05_phase, 2*pi*cav05_frequency);
cav06_x = 0.0;
cav06_y = 0.0;
cav06_z = 7.52;
cav06_scale = 6000000.0;
cav06_oncrest_phase = -48.28704996254389;
cav06_relative_phase = -180;
cav06_phase = (cav06_oncrest_phase + cav06_relative_phase)*pi/180;
cav06_k = 0;
cav06_frequency = 1300000000.0;
Map25D_TM("wcs", cav06_x, cav06_y, cav06_z, 1, 0, 0, 0, 1, 0, "fields/7cell_2D.gdf", "r", "z", "Er", "Ez", "Bphi", cav06_scale, cav06_k, cav06_phase, 2*pi*cav06_frequency);
